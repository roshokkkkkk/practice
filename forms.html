<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="forms.css">
    <title>Формы заявок</title>
</head>
<body>
<div class="container">
    <h1>Форма заявки на курсы "Корочки.есть"</h1>

    <form id="courseForm">
        <label>ФИО:</label>
        <input type="text" id="fullName" required>

        <label>Дата:</label>
        <input type="date" id="date" required>

        <label>Способ оплаты:</label>
        <select id="pay" required>
            <option value="">Выберите способ</option>
            <option value="Наличные">Наличные</option>
            <option value="Банковская карта">Банковская карта</option>
        </select>

        <label>Курс:</label>
        <select id="services" required>
            <option value="">Выберите курс</option>
            <option value="Основы алгоритмизации и программирования">Основы алгоритмизации и программирования</option>
            <option value="Основы веб-дизайна">Основы веб-дизайна</option>
            <option value="Основы проектирования баз данных">Основы проектирования баз данных</option>
        </select>

        <button type="submit">Отправить заявку</button>
    </form>
    <div class="btn">
    <p><a class="Enter" href="seeforms.html">Просмотреть свои заявки</a></p>
    <p><a href="autorize.html">Выйти</a></p>
    </div>
</div>

<script>
document.getElementById('courseForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const fullNameInput = document.getElementById('fullName');
    const dateInput = document.getElementById('date');
    const payInput = document.getElementById('pay');
    const courseInput = document.getElementById('services');

    const fullName = fullNameInput.value.trim();
    const date = dateInput.value;

    // Удаляем прошлые ошибки
    document.querySelectorAll(".error").forEach(el => el.remove());

    let valid = true;

    // --- 1) Проверка ФИО ---
    const fioRegex = /^[А-ЯЁа-яё ]+$/;
    if (!fioRegex.test(fullName)) {
        showError(fullNameInput, "ФИО может содержать только кириллицу и пробелы");
        valid = false;
    }

    // --- 2) Проверка даты ---
    const today = new Date();
    today.setHours(0, 0, 0, 0);  
    const selectedDate = new Date(date);

    if (!date || selectedDate < today) {
        showError(dateInput, "Дата не может быть прошедшей");
        valid = false;
    }

    if (!valid) return;

    // --- Сохраняем заявку ---
    const order = {
        name: fullName,
        date: date,
        pay: payInput.value,
        course: courseInput.value,
        completed: false,
        review: '',
        status: null,
    };

    let orders = JSON.parse(localStorage.getItem('orders')) || [];
    orders.push(order);
    localStorage.setItem('orders', JSON.stringify(orders));

    // Переход после сохранения
    window.location.href = 'seeforms.html';
});

// Функция показа ошибок под полем
function showError(input, message) {
    const div = document.createElement('div');
    div.className = 'error';
    div.style.color = 'red';
    div.style.fontSize = '14px';
    div.style.marginTop = '4px';
    div.textContent = message;
    input.insertAdjacentElement("afterend", div);
}

</script>

</body>
</html>
