<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="register.css">
    <title>Регистрация</title>  
</head>
<body>
    <div class="registration-form">
        <h2>Регистрация</h2>
        <form id="registrationForm">
            <input type="text" id="fullName" placeholder="ФИО" required>
            <span class="error" id="err-fio"></span>

            <input type="tel" id="phone" placeholder="Номер телефона" required>
            <span class="error" id="err-phone"></span>

            <input type="email" id="email" placeholder="Email" required>
            <span class="error" id="err-email"></span>

            <input type="text" id="username" placeholder="Логин" required>
            <span class="error" id="err-username"></span>

            <input type="password" id="password" placeholder="Пароль" required>
            <span class="error" id="err-password"></span>

            <p id="success" style="color: green;"></p>

            <button type="submit">Зарегистрироваться</button>
            <p>Или уже есть аккаунт? <a class="Enter" href="autorize.html">Войти</a></p>
        </form>
    </div>
</body>
<script>
// ====== МАСКА ТЕЛЕФОНА ======
const phoneInput = document.getElementById('phone');

phoneInput.addEventListener('input', () => {
    let digits = phoneInput.value.replace(/\D/g, '');

    if (digits.startsWith('7')) {
        digits = '8' + digits.slice(1);
    }
    if (!digits.startsWith('8')) {
        digits = '8' + digits;
    }

    let formatted = '8';

    if (digits.length > 1) {
        formatted += '(' + digits.slice(1, 4);
    }
    if (digits.length >= 4) {
        formatted += ')';
    }
    if (digits.length >= 5) {
        formatted += digits.slice(4, 7);
    }
    if (digits.length >= 8) {
        formatted += '-' + digits.slice(7, 9);
    }
    if (digits.length >= 10) {
        formatted += '-' + digits.slice(9, 11);
    }

    phoneInput.value = formatted;
});

// ====== РЕГИСТРАЦИЯ ======
document.getElementById('registrationForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const fullName = fullNameInput = document.getElementById('fullName').value.trim();
    const phone = phoneInput.value.trim();
    const email = document.getElementById('email').value.trim();
    const username = document.getElementById('username').value.trim();
    const password = document.getElementById('password').value;

    const errFio = document.getElementById('err-fio');
    const errPhone = document.getElementById('err-phone');
    const errEmail = document.getElementById('err-email');
    const errUsername = document.getElementById('err-username');
    const errPassword = document.getElementById('err-password');
    const success = document.getElementById('success');

    errFio.textContent = '';
    errPhone.textContent = '';
    errEmail.textContent = '';
    errUsername.textContent = '';
    errPassword.textContent = '';
    success.textContent = '';

    let valid = true;

    // ФИО
    if (!/^[А-ЯЁа-яё ]+$/.test(fullName)) {
        errFio.textContent = 'ФИО должно содержать только кириллицу и пробелы.';
        valid = false;
    }

    // Телефон
    if (!/^8\(\d{3}\)\d{3}-\d{2}-\d{2}$/.test(phone)) {
        errPhone.textContent = 'Телефон должен быть в формате 8(XXX)XXX-XX-XX.';
        valid = false;
    }

    // Email
    if (!email.includes('@')) {
        errEmail.textContent = 'Введите корректный email.';
        valid = false;
    }

    // Логин
    if (!/^[A-Za-z0-9]{6,}$/.test(username)) {
        errUsername.textContent = 'Логин — минимум 6 символов, латиница и цифры.';
        valid = false;
    }

    // Пароль
    if (password.length < 8) {
        errPassword.textContent = 'Пароль должен содержать минимум 8 символов.';
        valid = false;
    }

    if (!valid) return;

    let users = JSON.parse(localStorage.getItem('users')) || [];

    if (users.find(u => u.username === username)) {
        errUsername.textContent = 'Этот логин уже занят.';
        return;
    }

    users.push({ fullName, phone, email, username, password });
    localStorage.setItem('users', JSON.stringify(users));

    success.textContent = 'Регистрация прошла успешно!';
    document.getElementById('registrationForm').reset();

    setTimeout(() => {
        window.location.href = 'autorize.html';
    }, 1000);
});
</script>



</html> 
